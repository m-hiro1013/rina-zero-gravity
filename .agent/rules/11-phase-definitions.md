---
trigger: always_on
slug: phase-definitions
inheritance: core
scope: project_local
---
# フェーズ定義 (Phase Definitions)

> ワークフローはフェーズの組み合わせで構成される

## 概要

**フェーズ**とは、ワークフロー内の1つのステップ。
各フェーズはマクロな「プロジェクトライフサイクル」に従属する。

---

## 初期フェーズ一覧

### 1. 要件定義フェーズ（Requirements Definition）
- **マクロ従属**: Phase 0
- **目的**: ユーザーの意図を構造化し、実装可能な仕様にする
- **担当Agent**: Planner
- **成果物**: PROJECT_SPECIFIC.yaml

### 2. 環境構築フェーズ（Environment Setup）
- **マクロ従属**: Phase 1
- **目的**: 開発に必要な環境を準備する
- **担当Agent**: Coder
- **成果物**: ディレクトリ構造、依存関係、初期ファイル

### 3. 現状把握フェーズ（Current State Analysis）
- **マクロ従属**: Phase 2 (Bug Fix / Change)
- **目的**: 修正・改善対象の現在の状態を理解する
- **担当Agent**: Planner
- **成果物**: 現状分析レポート

### 4. 影響範囲特定フェーズ（Impact Analysis）
- **マクロ従属**: Phase 2 (Change)
- **目的**: 変更が影響する範囲を特定する
- **担当Agent**: Planner
- **成果物**: 影響範囲リスト

### 5. 質問の構造化フェーズ（Question Structuring）
- **マクロ従属**: Phase 0 / Phase 2
- **目的**: 情報取得のための質問を明確にする
- **担当Agent**: Planner
- **成果物**: 構造化された質問リスト

---

## 反復フェーズ一覧 (Phase 2)

### 1. 最小開発フェーズ（Minimal Development）
- **目的**: 今回のサイクルで作る最小単位を決め、実装する
- **担当Agent**: Planner → Coder
- **開始条件**: 前サイクル完了、または初期フェーズ完了
- **終了条件**: スコープ内の実装完了
- **成果物**: 実装済みコード

**実行内容**:
1. **ルール確認**: 関連ガイドライン（型安全、命名規則等）を再読
2. Planner: 今回のスコープ決定
3. Coder: コード実装（1ファイル1ターン）
4. 省略禁止、全文出力
5. **ルール照合**: 実装内容がルールを逸脱していないか最終確認

---

### 2. テストフェーズ（Test）
- **目的**: 実装した機能の動作確認
- **担当Agent**: Tester
- **開始条件**: 最小開発フェーズ完了
- **終了条件**: テスト結果レポート作成済み
- **成果物**: テスト結果レポート

**実行内容**:
1. **ルール確認**: テスト基準（39-testing-standards）をロード
2. 動作確認の実施
3. エッジケースのチェック
4. テスト結果の構造化
5. **ルール照合**: テスト品質が基準を満たしているか確認

---

### 3. デバッグフェーズ（Debug）
- **目的**: テストで発見された問題を修正
- **担当Agent**: Coder
- **開始条件**: テストフェーズで問題発見
- **終了条件**: テストが通る、または問題解決
- **成果物**: 修正済みコード

**実行内容**:
1. **ルール確認**: デバッグ・修正ルールをロード
2. 問題の原因特定
3. 修正実装
4. 再テスト
5. **ルール照合**: 修正によって別のルールを破っていないか確認

---

### 4. 完了フェーズ（Completion）
- **目的**: このサイクルの成果物が基準を満たしているか確認
- **担当Agent**: Reviewer
- **開始条件**: テストフェーズ合格
- **終了条件**: 成果物チェック完了
- **成果物**: 成果物チェック結果

**実行内容**:
1. **ルール確認**: 終了基準（20-lifecycle）をロード
2. 実装がスコープを満たしているか確認
3. コードが基準を満たしているか確認
4. **ルール照合**: チェック項目に漏れがないか確認

---

### 5. セルフチェックフェーズ（Self Check）
- **目的**: コード品質、セキュリティ、設計原則への準拠を検証
- **担当Agent**: Reviewer
- **開始条件**: 完了フェーズ合格
- **終了条件**: セルフチェック完了
- **成果物**: セルフチェック結果

**実行内容**:
1. **ルール確認**: セキュリティ（02-security）を含む全適用ルールをロード
2. **ルール照合**: 本セッションの全成果物を、適用ルールと一行ずつ突き合わせ検証
3. 問題があればその場で修正

---

### 6. 記憶の管理フェーズ（Memory Management）
- **目的**: セッション状態と知見を保存
- **担当Agent**: BookKeeper + DBManager
- **開始条件**: セルフチェックフェーズ完了
- **終了条件**: 状態保存完了
- **成果物**: WORKFLOW.yaml更新、知見追記

**実行内容**:
1. **ルール確認**: 進捗管理（13-progress-management）ルールの再読
2. BookKeeper: WORKFLOW.yaml更新
3. DBManager: 知見をDB（KNOWLEDGE.md/goku.md）に反映
4. **ルール照合**: セーブデータに漏れや矛盾がないか最終確認

### 7. 調査フェーズ（Investigation）
- **目的**: 必要な情報を調べる
- **担当Agent**: Planner

### 8. 整理フェーズ（Organization）
- **目的**: 収集した情報を整理する
- **担当Agent**: Planner

### 9. 回答作成フェーズ（Answer Creation）
- **目的**: ユーザーへの回答を作成
- **担当Agent**: Planner

---

## フェーズ間の遷移ルール

### 正常遷移
前のフェーズの終了条件を満たしたら次のフェーズへ。

### エラー遷移
- テストフェーズ失敗 → デバッグフェーズへ
- デバッグ後 → テストフェーズへ戻る（ループ）
- 重大エラー → ユーザー確認へエスカレーション

### サイクル終了
記憶の管理フェーズ完了 → 次のサイクルへ、または全体完了。
