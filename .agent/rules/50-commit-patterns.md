---
description: ユーザーからのCommit（依頼・指示）を4つのパターンに分類するためのルール
---

# Commitパターン定義 (Commit Patterns)

> Orchestratorが最初に行う判断: 「このCommitはどのパターンか？」

## 概要

**Commit**とは、ユーザーからの1つの依頼・指示・意図のこと。
すべてのCommitは以下の4パターンのいずれかに分類される。

## 4つのCommitパターン

### 1. 新規開発（New Development）

**定義**: ゼロから何かを作る依頼。

**判定キーワード**:
- 「作って」「作成して」「新しく」「始めて」
- 「〜を実装して」「〜を開発して」
- 「プロジェクトを開始」「アプリを作る」
- 「ゼロから」「スクラッチで」

**判定文脈**:
- 対象となるファイル・機能が存在しない
- `/start-project` コマンドが使われた
- 新規リポジトリの作成を伴う

**デフォルトワークフロー**:
```
初期フェーズ: 要件定義 → 環境構築
反復フェーズ: 最小開発 → テスト → デバッグ → 完了 → セルフチェック → 記憶の管理
典型的な反復回数: 3〜10サイクル（規模による）
```

**規模による見積もり**:
| 規模 | 説明 | 反復回数 |
|------|------|---------|
| 小 | 1ファイル、単機能 | 3サイクル |
| 中 | 複数ファイル、複数機能 | 5サイクル |
| 大 | フルアプリ、複雑な機能 | 10サイクル |

---

### 2. 修正・改善（Fix / Improvement）

**定義**: 既存のものを直す・良くする依頼。

**判定キーワード**:
- 「直して」「修正して」「バグ」「エラー」
- 「改善して」「リファクタ」「最適化」
- 「アップデート」「更新」「変更」
- 「〜が動かない」「〜がおかしい」

**判定文脈**:
- 対象となるファイル・機能が既に存在
- 問題の報告・改善要望を含む
- `/bug-fix` コマンドが使われた

**デフォルトワークフロー**:
```
初期フェーズ: 現状把握 → 影響範囲特定
反復フェーズ: 最小開発 → テスト → デバッグ → 完了 → セルフチェック → 記憶の管理
典型的な反復回数: 1〜3サイクル
```

**規模による見積もり**:
| 規模 | 説明 | 反復回数 |
|------|------|---------|
| 小 | 単一箇所の修正 | 1サイクル |
| 中 | 複数箇所に影響 | 2サイクル |
| 大 | 設計変更を伴う | 3サイクル |

---

### 3. 情報取得（Information Retrieval）

**定義**: 調査・確認・質問への回答を求める依頼。

**判定キーワード**:
- 「教えて」「説明して」「どうやって」
- 「調べて」「確認して」「レポート」
- 「何が」「なぜ」「どのように」
- 「〜とは」「〜について」

**判定文脈**:
- コードの変更を伴わない
- 情報の整理・提示が求められている
- 質問形式である

**デフォルトワークフロー**:
```
初期フェーズ: 質問の構造化
反復フェーズ: 調査 → 整理 → 回答作成 → セルフチェック → 記憶の管理
典型的な反復回数: 1サイクル
```

---

### 4. セッション管理（Session Management）

**定義**: 作業の開始・再開・保存・終了に関する依頼。

**判定キーワード**:
- 「始めよう」「続きから」「再開」
- 「保存して」「セーブして」「終わり」
- 「プロジェクト名」（挨拶代わり）
- `/start-project`, `/resume-session`, `/save-session`

**判定文脈**:
- セッション状態の変更が目的
- コード変更を直接伴わない

**デフォルトワークフロー**:
```
初期フェーズ: なし
反復フェーズ: 状態確認 → 実行 → 記憶の管理
典型的な反復回数: 1サイクル
```

---

## パターン判定のフロー

```
1. キーワードマッチング
   ↓
2. 文脈分析（対象の存在有無、コマンド使用）
   ↓
3. パターン決定
   ↓
4. ワークフローテンプレート選択
   ↓
5. 反復回数の見積もり
```

## 複合パターンの扱い

1つのCommitが複数パターンに該当する場合：

| 例 | 判定 | 理由 |
|----|------|------|
| 「バグ直して、あと新機能も追加して」 | 修正・改善 + 新規開発 | 2つのCommitに分割 |
| 「この機能について教えて、それで実装して」 | 情報取得 → 新規開発 | 順番に処理 |

**原則**: 複合パターンは分割して順番に処理する。

---

## Orchestratorへの指示

Commitを受け取ったら：

1. このルールファイルを参照
2. 4パターンのどれに該当するか判定
3. 判定結果をユーザーに確認（必要な場合）
4. 対応するワークフローテンプレートを選択
5. フェーズ実行を開始

---

## 用語対応

| 用語 | 意味 |
|------|------|
| Commit | ユーザーからの1つの依頼 |
| パターン | Commitの分類（4種類） |
| ワークフロー | パターンに対応する実行計画 |
| フェーズ | ワークフロー内の1ステップ |
| サイクル | 反復フェーズ1周分 |
