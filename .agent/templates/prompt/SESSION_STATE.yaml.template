# =====================================
# ğŸ’¾ SESSION_STATE.yaml
# =====================================
#
# ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã€‚
# OrchestratorãŒèª­ã¿æ›¸ãã—ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–“ã§å…±æœ‰ã™ã‚‹ã€‚
#
# =====================================

session:
  # ---------------------------------
  # åŸºæœ¬æƒ…å ±
  # ---------------------------------
  id: "{{SESSION_ID}}"
  started_at: "{{DATETIME}}"
  last_updated: "{{DATETIME}}"

  # ---------------------------------
  # Commitæƒ…å ±
  # ---------------------------------
  commit:
    original_request: |
      {{ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å…ƒã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ}}
    
    pattern: "æ–°è¦é–‹ç™º | ä¿®æ­£ãƒ»æ”¹å–„ | æƒ…å ±å–å¾— | ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†"
    pattern_confidence: 0.95  # ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¤å®šã®ç¢ºä¿¡åº¦
    
    classified_at: "{{DATETIME}}"
    classified_by: "Orchestrator"

  # ---------------------------------
  # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ
  # ---------------------------------
  workflow:
    template: "æ–°è¦é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ | ä¿®æ­£ãƒ»æ”¹å–„ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ | æƒ…å ±å–å¾—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ | ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼"
    
    initial_phases:
      - name: "è¦ä»¶å®šç¾©"
        status: "done | in_progress | pending"
        completed_at: "{{DATETIME}}"
      
      - name: "ç’°å¢ƒæ§‹ç¯‰"
        status: "done | in_progress | pending"
        completed_at: "{{DATETIME}}"
    
    iterative_phases:
      - "æœ€å°é–‹ç™º"
      - "ãƒ†ã‚¹ãƒˆ"
      - "ãƒ‡ãƒãƒƒã‚°"
      - "å®Œäº†"
      - "ã‚»ãƒ«ãƒ•ãƒã‚§ãƒƒã‚¯"
      - "è¨˜æ†¶ã®ç®¡ç†"

  # ---------------------------------
  # ã‚µã‚¤ã‚¯ãƒ«é€²æ—
  # ---------------------------------
  cycle:
    estimated_total: 5           # è¦‹ç©ã‚‚ã‚Šåå¾©å›æ•°
    current: 1                   # ç¾åœ¨ã®ã‚µã‚¤ã‚¯ãƒ«ç•ªå·
    
    current_phase: "æœ€å°é–‹ç™º"    # ç¾åœ¨ã‚µã‚¤ã‚¯ãƒ«å†…ã®ãƒ•ã‚§ãƒ¼ã‚º
    phase_started_at: "{{DATETIME}}"
    
    history:
      - cycle_number: 1
        started_at: "{{DATETIME}}"
        completed_at: "{{DATETIME}}"
        summary: "èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…"
        files_modified:
          - "src/auth/login.ts"
          - "src/auth/middleware.ts"
        issues_found: 0
        
      # ä»¥ä¸‹ã€ã‚µã‚¤ã‚¯ãƒ«ã”ã¨ã«è¿½åŠ 

  # ---------------------------------
  # ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ± (OrchestratorãŒç®¡ç†)
  # ---------------------------------
  session_info:
    phase: "{{current_phase}}"
    cycle: {{current_cycle}}
    status: "active"
    start_time: "{{start_time}}"
  
  # ---------------------------------
  # è‡ªå·±æˆé•·ãƒ»ä¾å­˜é–¢ä¿‚ç®¡ç†ç”¨ (new)
  # ---------------------------------
  self_growth:
    original_commit: "{{original_commit}}"  # å…ƒã®Commitå†…å®¹
    current_context: "{{current_context}}"  # ç¾åœ¨ä½•ã‚’ã—ã¦ã„ã‚‹ã‹
    
    dependency_stack: []  # ä¾å­˜é–¢ä¿‚ã‚¹ã‚¿ãƒƒã‚¯
      # - id: "task_1"
      #   agent: "ChatApp"
      #   status: "pending"
      #   waiting_for: "SQLOperator"
    
    missing_agents: []  # ä¸è¶³ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸€è¦§
    agents_in_creation: []  # ä½œæˆä¸­ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸€è¦§
    
    preparation_status: "pending"  # pending | in_progress | completed

  # ---------------------------------
  # ãƒ•ã‚§ãƒ¼ã‚ºçŠ¶æ…‹
  # ---------------------------------
  phase:
    current: "æœ€å°é–‹ç™º"
    status: "in_progress"
    started_at: "{{DATETIME}}"
    
    # ç¾åœ¨ãƒ•ã‚§ãƒ¼ã‚ºã®è©³ç´°
    details:
      agent: "Coder"
      scope: "èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®å®Ÿè£…"
      files_in_scope:
        - "src/auth/middleware.ts"
      progress: 50  # ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆ

  # ---------------------------------
  # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹
  # ---------------------------------
  agents:
    active:
      - agent: "Coder"
        task: "middleware.ts ã®å®Ÿè£…"
        started_at: "{{DATETIME}}"
    
    waiting:
      - agent: "Tester"
        waiting_for: "Coderã®å®Œäº†"
    
    completed:
      - agent: "Planner"
        task: "ã‚¹ã‚³ãƒ¼ãƒ—å®šç¾©"
        completed_at: "{{DATETIME}}"
        result: "success"

  # ---------------------------------
  # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèªãƒã‚¤ãƒ³ãƒˆ
  # ---------------------------------
  checkpoint:
    next_checkpoint: "è¦‹ç©ã‚‚ã‚Šã‚µã‚¤ã‚¯ãƒ«å®Œäº†å¾Œ"
    cycles_until_checkpoint: 4
    
    last_checkpoint:
      at: "{{DATETIME}}"
      reason: "ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹"
      user_response: "ç¶šè¡Œ"
    
    pending_confirmations: []

  # ---------------------------------
  # ã‚¨ãƒ©ãƒ¼å±¥æ­´
  # ---------------------------------
  errors:
    - timestamp: "{{DATETIME}}"
      phase: "ãƒ†ã‚¹ãƒˆ"
      cycle: 1
      severity: "warning | error | critical"
      description: "ãƒ†ã‚¹ãƒˆå¤±æ•—: auth.test.ts"
      resolution: "ãƒ‡ãƒãƒƒã‚°ã§ä¿®æ­£æ¸ˆã¿"

  # ---------------------------------
  # çŸ¥è¦‹å€™è£œ
  # ---------------------------------
  knowledge_candidates:
    - insight: "JWTã®æœ‰åŠ¹æœŸé™ã¯çŸ­ã‚ã«è¨­å®šã™ã‚‹ã¨å®‰å…¨"
      weight: "+2"
      category: "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£"
      should_persist: true

  # ---------------------------------
  # ãƒ¡ã‚¿æƒ…å ±
  # ---------------------------------
  meta:
    project_name: "{{PROJECT_NAME}}"
    project_path: "{{PROJECT_PATH}}"
    workflow_yaml: "prompt/WORKFLOW.yaml"
    knowledge_md: "prompt/KNOWLEDGE.md"
