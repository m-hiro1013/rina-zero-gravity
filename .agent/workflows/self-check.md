---
description: 作業の各フェーズでルールに従っているかを確認し、気づき・改善点をその場で修正する
---

# /self-check - セルフチェック ワークフロー

> 原則に従っているかを確認する。外れていたらその場で修正する。

## 概要

作業中に定期的に実行し、原則に従っているかを確認する。
気づきや改善点があればその場で修正し、正しいワークフローで作業を進める。

## トリガー

- 作業の区切りごと（1ファイル作成後、1機能完了後など）
- 「あれ？これで合ってる？」と思った時
- エラーや問題が発生した時
- セッション終了前

## Step 1: 原則チェックリスト

以下の原則に従っているか確認する：

### 1.1 目次ファースト原則

```
✅ チェック項目:
- [ ] 情報にアクセスする前にINDEXを確認したか
- [ ] 必要な情報だけにアクセスしたか
- [ ] ファイル追加・変更時にINDEXを更新したか
```

違反の場合:
→ `/update-index` を実行してINDEXを更新

### 1.2 100%管理領域の原則（MAA）

```
✅ チェック項目:
- [ ] Core Agents (Orchestrator, BookKeeper, DBManager, GrowthMonitor) の役割を尊重しているか
- [ ] DB操作はDBManager経由か
- [ ] エージェント追加時はBOOKに登録したか
```

違反の場合:
→ 該当するCore Agentのルールに従って修正

### 1.3 省略禁止ルール

```
✅ チェック項目:
- [ ] コード出力時に「// 既存コード」「// 省略」を使っていないか
- [ ] 全文を出力しているか
```

違反の場合:
→ 全文を出力し直す

### 1.4 1ファイル1ターンルール

```
✅ チェック項目:
- [ ] ユーザーの確認なしに複数ファイルを一気に変更していないか
- [ ] 「次いこ！」を待っているか
```

違反の場合:
→ 一旦中断してユーザーに確認を求める

### 1.5 セキュリティルール

```
✅ チェック項目:
- [ ] APIキーをハードコードしていないか
- [ ] .envをGitにコミットしていないか
- [ ] 危険な操作の前にユーザー確認を求めたか
```

違反の場合:
→ 即座に修正、必要なら警告を出す

### 1.6 PDCAサイクル

```
✅ チェック項目:
- [ ] 小さく計画→実行→確認→改善 を回しているか
- [ ] 大きな変更を一気にやっていないか
- [ ] 各ステップで結果を確認しているか
```

違反の場合:
→ 作業を分割して小さく進める

## Step 2: 気づき・改善点の記録

チェック中に見つけた気づきや改善点を記録する：

```markdown
【気づき】
- {{気づき1}}
- {{気づき2}}

【改善点】
- {{改善点1}} → {{即座に修正}}
- {{改善点2}} → {{後で対応}}
```

## Step 3: 即時修正

見つけた問題をその場で修正する：

```
🔧 即時修正中...

【修正内容】
- {{修正1}}
- {{修正2}}

修正完了！✅
```

## Step 4: 知見として蓄積

重要な気づきは知見として記録：

```
🌱 知見として記録:

- {{知見}} [+{{ウェイト}}]
```

→ KNOWLEDGE.md または goku.md に追記

## Step 5: 作業再開

```
✅ セルフチェック完了！

【確認結果】
- 目次ファースト原則: ✅
- 100%管理領域の原則: ✅
- 省略禁止ルール: ✅
- 1ファイル1ターンルール: ✅
- セキュリティルール: ✅
- PDCAサイクル: ✅

【修正した点】
- {{修正点}}

作業を続けるね！
```

## 自動セルフチェックのタイミング

| タイミング | チェック内容 |
|-----------|-------------|
| ファイル作成後 | INDEX更新確認 |
| コード出力後 | 省略禁止確認 |
| 複数ファイル変更時 | 1ファイル1ターン確認 |
| DB操作前 | DBManager経由確認 |
| セッション終了前 | 全項目チェック |

## 完了条件

- [ ] 全チェック項目を確認
- [ ] 違反があれば即座に修正
- [ ] 重要な気づきを知見として記録
- [ ] 作業を正しいワークフローで再開

## 注意事項

⚠️ セルフチェックを飛ばさない
⚠️ 違反を見つけたら「後で直す」はNG、今すぐ直す
⚠️ 小さな違反も見逃さない、大きな問題の種になる
